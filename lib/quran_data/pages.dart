import 'dart:typed_data';

import 'package:quran_memorization_helper/models/settings.dart';

final Uint16List _para16LinePageOffsets = Uint16List.fromList(<int>[
  1, // 1
  20, // 2
  38, // 3
  56, // 4
  74, // 5
  92, // 6
  110, // 7
  128, // 8
  146, // 9
  164, // 10
  182, // 11
  200, // 12
  218, // 13
  236, // 14
  254, // 15
  272, // 16
  290, // 17
  308, // 18
  326, // 19
  344, // 20
  362, // 21
  380, // 22
  398, // 23
  416, // 24
  434, // 25
  452, // 26
  470, // 27
  488, // 28
  508, // 29
  528, // 30
]);

final Uint16List _para15LinePageOffsets = Uint16List.fromList([
  0, // 1
  21, // 2
  41, // 3
  61, // 4
  81, // 5
  101, // 6
  121, // 7
  141, // 8
  161, // 9
  181, // 10
  201, // 11
  221, // 12
  241, // 13
  261, // 14
  281, // 15
  301, // 16
  321, // 17
  341, // 18
  361, // 19
  381, // 20
  401, // 21
  421, // 22
  441, // 23
  461, // 24
  481, // 25
  501, // 26
  521, // 27
  541, // 28
  561, // 29
  581, // 30
]);

final Uint16List _para15LineIndoPakPageOffsets = Uint16List.fromList([
  1, // 1
  22, // 2
  42, // 3
  62, // 4
  82, // 5
  102, // 6
  122, // 7
  142, // 8
  162, // 9
  182, // 10
  202, // 11
  222, // 12
  242, // 13
  262, // 14
  282, // 15
  302, // 16
  322, // 17
  342, // 18
  362, // 19
  382, // 20
  402, // 21
  422, // 22
  442, // 23
  462, // 24
  482, // 25
  502, // 26
  522, // 27
  542, // 28
  562, // 29
  586, // 30
]);

Uint16List paraPageOffsetsList(Mushaf mushaf) {
  return switch (mushaf) {
    Mushaf.Indopak16Line => _para16LinePageOffsets,
    Mushaf.Uthmani15Line => _para15LinePageOffsets,
    Mushaf.Indopak15Line => _para15LineIndoPakPageOffsets,
  };
}

int pageCountForPara(int paraIdx, Mushaf mushaf) {
  if (paraIdx == 29) {
    return switch (mushaf) {
      Mushaf.Indopak16Line => 22,
      Mushaf.Uthmani15Line => 23,
      Mushaf.Indopak15Line => 25,
    };
  }

  final list = paraPageOffsetsList(mushaf);
  int p1 = list[paraIdx];
  int p2 = list[paraIdx + 1];
  return p2 - p1;
}

int paraForPage(int page, Mushaf mushaf) {
  if (mushaf == Mushaf.Indopak16Line && (page < 1 || page > 548)) {
    throw "Invalid page number: $page";
  } else if (mushaf == Mushaf.Uthmani15Line && (page < 0 || page > 604)) {
    throw "Invalid page number: $page";
  }

  final list = paraPageOffsetsList(mushaf);
  for (int i = 0; i < 30; ++i) {
    if (page >= list[i]) {
      continue;
    }
    return i - 1;
  }
  return 30 - 1;
}

final Uint16List surah16LinePageOffset = Uint16List.fromList(<int>[
  1,
  2,
  45,
  69,
  96,
  115,
  136,
  159,
  168,
  187,
  199,
  212,
  224,
  230,
  235,
  240,
  254,
  264,
  275,
  281,
  290,
  299,
  308,
  315,
  324,
  330,
  339,
  347,
  357,
  364,
  370,
  373,
  376,
  385,
  391,
  396,
  401,
  408,
  412,
  420,
  429,
  434,
  440,
  446,
  448,
  452,
  456,
  460,
  463,
  466,
  468,
  471,
  473,
  475,
  478,
  481,
  484,
  488,
  491,
  495,
  497,
  499,
  500,
  502,
  504,
  506,
  508,
  510,
  512,
  514,
  516,
  518,
  520,
  521,
  523,
  524,
  526,
  528,
  529,
  530,
  532,
  532,
  533,
  534,
  535,
  536,
  537,
  537,
  538,
  539,
  540,
  540,
  541,
  541,
  542,
  542,
  543,
  543,
  544,
  544,
  544,
  545,
  545,
  545,
  546,
  546,
  546,
  546,
  547,
  547,
  547,
  547,
  548,
  548,
]);

final Uint16List surah15LinePageOffset = Uint16List.fromList(<int>[
  0,
  1,
  49,
  76,
  105,
  127,
  150,
  176,
  186,
  207,
  220,
  234,
  248,
  254,
  261,
  266,
  281,
  292,
  304,
  311,
  321,
  331,
  341,
  349,
  358,
  366,
  376,
  384,
  395,
  403,
  410,
  414,
  417,
  427,
  433,
  439,
  445,
  452,
  457,
  466,
  476,
  482,
  488,
  495,
  498,
  501,
  506,
  510,
  514,
  517,
  519,
  522,
  525,
  527,
  530,
  533,
  536,
  541,
  544,
  548,
  550,
  552,
  553,
  555,
  557,
  559,
  561,
  563,
  565,
  567,
  569,
  571,
  573,
  574,
  576,
  577,
  579,
  581,
  582,
  584,
  585,
  586,
  586,
  588,
  589,
  590,
  590,
  591,
  592,
  592,
  593,
  594,
  594,
  595,
  595,
  596,
  596,
  597,
  597,
  598,
  598,
  599,
  599,
  600,
  600,
  601,
  601,
  601,
  602,
  602,
  602,
  603,
  603,
  603,
]);

final Uint16List surah15LineIndopakPageOffset = Uint16List.fromList(<int>[
  1,
  2,
  50,
  77,
  106,
  128,
  151,
  177,
  187,
  208,
  221,
  235,
  249,
  255,
  261,
  267,
  282,
  293,
  305,
  312,
  322,
  331,
  342,
  350,
  359,
  366,
  376,
  385,
  396,
  404,
  411,
  415,
  418,
  428,
  434,
  440,
  445,
  452,
  458,
  467,
  477,
  483,
  489,
  495,
  498,
  502,
  506,
  511,
  515,
  518,
  520,
  523,
  526,
  528,
  531,
  534,
  537,
  542,
  545,
  549,
  551,
  553,
  554,
  556,
  558,
  560,
  562,
  564,
  567,
  569,
  571,
  573,
  576,
  578,
  580,
  582,
  584,
  586,
  587,
  589,
  590,
  591,
  592,
  594,
  595,
  596,
  597,
  598,
  600,
  600,
  601,
  602,
  602,
  603,
  603,
  604,
  604,
  605,
  605,
  606,
  606,
  607,
  607,
  607,
  608,
  608,
  608,
  608,
  609,
  609,
  609,
  609,
  610,
  610,
]);
